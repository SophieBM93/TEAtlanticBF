theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
legend.position = c(1,1),
legend.justification = c("right", "top"),
legend.box.just = "right",
legend.margin = margin(6, 6, 6, 6),
legend.title = element_blank(),
legend.background = element_blank(),
axis.line = element_line(colour = "black"))
p3
#Extract the varibales of interest
envNMDS <- cbind(env2$`Age [ka]`, env2$`DO3[mL/L]`, env2$`Infaunals[%]`,
env2$`Epibenthic[%]`, env2$`Calcareous[%]`, env2$`Porcellaneous[%]`)
envNMDS <- as.data.frame(envNMDS)
colnames(envNMDS)<- c("Age (ka)", "BWOx[mL/L]", "Infaunals [%]",
"Epifaunals [%]", "Calcareous [%]",
"Porcellaneous [%]")
str(envNMDS)
#Plot variables in the NMDS
env <- envNMDS[2:6]
en = envfit(nmds, env, permutations = 999, na.rm = TRUE)                 #Do the environmnetal fit
data.scores = as.data.frame(scores(nmds, display="species"))
en_coord_cont = as.data.frame(scores(en, "vectors")) * ordiArrowMul(en)
en_coord_cat = as.data.frame(scores(en, "factors")) * ordiArrowMul(en)
#Plot the results
p3<- ggplot(data = data.scores, aes(x = NMDS1, y = NMDS2))+
geom_segment(data = en_coord_cont, aes(x = 0, y = 0, xend = NMDS1, yend = NMDS2),
size =0.5, alpha = 0.5, colour = "grey30") +
# geom_point(data = en_coord_cat, aes(x = NMDS1, y = NMDS2),
#            shape = "diamond", size = 4, alpha = 0.6, colour = "navy") +
# geom_text(data = en_coord_cat, aes(x = NMDS1, y = NMDS2+0.04),
#           label = row.names(en_coord_cat), colour = "navy", fontface = "bold", size=4) +
geom_text(data = en_coord_cont, aes(x = NMDS1, y = NMDS2), colour = "grey30",
fontface = "bold", size=4, label = row.names(en_coord_cont)) +
geom_point(data=subset(fort, score=='sites'),
mapping=aes(x=NMDS1, y=NMDS2, colour=factor(env.9512$Time)),
alpha=0.5)+
geom_segment(data=subset(fort, score=='species'),
mapping=aes(x=0, y=0, xend=NMDS1, yend=NMDS2),
arrow = arrow(length =unit(0.015, "npc"), type="closed"),
colour="darkgray", size=0, alpha=0)+
geom_text(data=subset(fort, score=='sites'),
mapping = aes(label=label, x=NMDS1*1, y=NMDS2*1),size=3,
family="sans", fontface="italic", alpha=0)+
geom_abline(intercept = 0, slope=0, linetype="dashed", size=0.5, colour="black")+
geom_vline(aes(xintercept=0), linetype="dashed", size=0.5, colour="black")+
scale_x_continuous(guide="prism_minor",
breaks = seq(-20,20,by=1),
limits = c(-2,2),
expand = c(0,0),
minor_breaks=seq(-20,20, 0.5))+
scale_y_continuous(guide="prism_minor",
breaks = seq(-20,20,by=0.5),
limits = c(-1,1),
expand = c(0,0),
minor_breaks=seq(-20,20, 0.25))+
xlab("")+ylab("")+
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
legend.position = c(1,1),
legend.justification = c("right", "top"),
legend.box.just = "right",
legend.margin = margin(6, 6, 6, 6),
legend.title = element_blank(),
legend.background = element_blank(),
axis.line = element_line(colour = "black"))
p3
#Plot the results
p3<- ggplot(data = data.scores, aes(x = NMDS1, y = NMDS2))+
geom_segment(data = en_coord_cont, aes(x = 0, y = 0, xend = NMDS1, yend = NMDS2),
size =0.5, alpha = 0.5, colour = "grey30") +
# geom_point(data = en_coord_cat, aes(x = NMDS1, y = NMDS2),
#            shape = "diamond", size = 4, alpha = 0.6, colour = "navy") +
# geom_text(data = en_coord_cat, aes(x = NMDS1, y = NMDS2+0.04),
#           label = row.names(en_coord_cat), colour = "navy", fontface = "bold", size=4) +
geom_text(data = en_coord_cont, aes(x = NMDS1, y = NMDS2), colour = "grey30",
fontface = "bold", size=4, label = row.names(en_coord_cont)) +
geom_point(data=subset(fort, score=='sites'),
mapping=aes(x=NMDS1, y=NMDS2, colour=factor(env.9512$Time)),
alpha=0.5)+
geom_segment(data=subset(fort, score=='species'),
mapping=aes(x=0, y=0, xend=NMDS1, yend=NMDS2),
arrow = arrow(length =unit(0.015, "npc"), type="closed"),
colour="darkgray", size=0, alpha=0)+
geom_text(data=subset(fort, score=='sites'),
mapping = aes(label=label, x=NMDS1*1, y=NMDS2*1),size=3,
family="sans", fontface="italic", alpha=0)+
geom_abline(intercept = 0, slope=0, linetype="dashed", size=0.5, colour="black")+
geom_vline(aes(xintercept=0), linetype="dashed", size=0.5, colour="black")+
scale_x_continuous(guide="prism_minor",
breaks = seq(-20,20,by=1),
limits = c(-2,2),
expand = c(0,0),
minor_breaks=seq(-20,20, 0.5))+
scale_y_continuous(guide="prism_minor",
breaks = seq(-20,20,by=0.5),
limits = c(-1,1),
expand = c(0,0),
minor_breaks=seq(-20,20, 0.25))+
xlab("")+ylab("")+
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
legend.position = c(0.5),
legend.justification = c("right", "top"),
legend.box.just = "right",
legend.margin = margin(6, 6, 6, 6),
legend.title = element_blank(),
legend.background = element_blank(),
axis.line = element_line(colour = "black"))
p3
p3
#Plot the results
p3<- ggplot(data = data.scores, aes(x = NMDS1, y = NMDS2))+
geom_segment(data = en_coord_cont, aes(x = 0, y = 0, xend = NMDS1, yend = NMDS2),
size =0.5, alpha = 0.5, colour = "grey30") +
# geom_point(data = en_coord_cat, aes(x = NMDS1, y = NMDS2),
#            shape = "diamond", size = 4, alpha = 0.6, colour = "navy") +
# geom_text(data = en_coord_cat, aes(x = NMDS1, y = NMDS2+0.04),
#           label = row.names(en_coord_cat), colour = "navy", fontface = "bold", size=4) +
geom_text(data = en_coord_cont, aes(x = NMDS1, y = NMDS2), colour = "grey30",
fontface = "bold", size=4, label = row.names(en_coord_cont)) +
geom_point(data=subset(fort, score=='sites'),
mapping=aes(x=NMDS1, y=NMDS2, colour=factor(env.9512$Time)),
alpha=0.5)+
geom_segment(data=subset(fort, score=='species'),
mapping=aes(x=0, y=0, xend=NMDS1, yend=NMDS2),
arrow = arrow(length =unit(0.015, "npc"), type="closed"),
colour="darkgray", size=0, alpha=0)+
geom_text(data=subset(fort, score=='sites'),
mapping = aes(label=label, x=NMDS1*1, y=NMDS2*1),size=3,
family="sans", fontface="italic", alpha=0)+
geom_abline(intercept = 0, slope=0, linetype="dashed", size=0.5, colour="black")+
geom_vline(aes(xintercept=0), linetype="dashed", size=0.5, colour="black")+
scale_x_continuous(guide="prism_minor",
breaks = seq(-20,20,by=1),
limits = c(-2,2),
expand = c(0,0),
minor_breaks=seq(-20,20, 0.5))+
scale_y_continuous(guide="prism_minor",
breaks = seq(-20,20,by=0.5),
limits = c(-1,1),
expand = c(0,0),
minor_breaks=seq(-20,20, 0.25))+
xlab("")+ylab("")+
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
legend.position = c(0.5,1),
legend.justification = c("right", "top"),
legend.box.just = "right",
legend.margin = margin(6, 6, 6, 6),
legend.title = element_blank(),
legend.background = element_blank(),
axis.line = element_line(colour = "black"))
#Plot the results
p3<- ggplot(data = data.scores, aes(x = NMDS1, y = NMDS2))+
geom_segment(data = en_coord_cont, aes(x = 0, y = 0, xend = NMDS1, yend = NMDS2),
size =0.5, alpha = 0.5, colour = "grey30") +
# geom_point(data = en_coord_cat, aes(x = NMDS1, y = NMDS2),
#            shape = "diamond", size = 4, alpha = 0.6, colour = "navy") +
# geom_text(data = en_coord_cat, aes(x = NMDS1, y = NMDS2+0.04),
#           label = row.names(en_coord_cat), colour = "navy", fontface = "bold", size=4) +
geom_text(data = en_coord_cont, aes(x = NMDS1, y = NMDS2), colour = "grey30",
fontface = "bold", size=4, label = row.names(en_coord_cont)) +
geom_point(data=subset(fort, score=='sites'),
mapping=aes(x=NMDS1, y=NMDS2, colour=factor(env.9512$Time)),
alpha=0.5)+
geom_segment(data=subset(fort, score=='species'),
mapping=aes(x=0, y=0, xend=NMDS1, yend=NMDS2),
arrow = arrow(length =unit(0.015, "npc"), type="closed"),
colour="darkgray", size=0, alpha=0)+
geom_text(data=subset(fort, score=='sites'),
mapping = aes(label=label, x=NMDS1*1, y=NMDS2*1),size=3,
family="sans", fontface="italic", alpha=0)+
geom_abline(intercept = 0, slope=0, linetype="dashed", size=0.5, colour="black")+
geom_vline(aes(xintercept=0), linetype="dashed", size=0.5, colour="black")+
scale_x_continuous(guide="prism_minor",
breaks = seq(-20,20,by=1),
limits = c(-2,2),
expand = c(0,0),
minor_breaks=seq(-20,20, 0.5))+
scale_y_continuous(guide="prism_minor",
breaks = seq(-20,20,by=0.5),
limits = c(-1,1),
expand = c(0,0),
minor_breaks=seq(-20,20, 0.25))+
xlab("")+ylab("")+
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
legend.position = c(0.5,0.5),
legend.justification = c("right", "top"),
legend.box.just = "right",
legend.margin = margin(6, 6, 6, 6),
legend.title = element_blank(),
legend.background = element_blank(),
axis.line = element_line(colour = "black"))
p3
#Plot the results
p3<- ggplot(data = data.scores, aes(x = NMDS1, y = NMDS2))+
geom_segment(data = en_coord_cont, aes(x = 0, y = 0, xend = NMDS1, yend = NMDS2),
size =0.5, alpha = 0.5, colour = "grey30") +
# geom_point(data = en_coord_cat, aes(x = NMDS1, y = NMDS2),
#            shape = "diamond", size = 4, alpha = 0.6, colour = "navy") +
# geom_text(data = en_coord_cat, aes(x = NMDS1, y = NMDS2+0.04),
#           label = row.names(en_coord_cat), colour = "navy", fontface = "bold", size=4) +
geom_text(data = en_coord_cont, aes(x = NMDS1, y = NMDS2), colour = "grey30",
fontface = "bold", size=4, label = row.names(en_coord_cont)) +
geom_point(data=subset(fort, score=='sites'),
mapping=aes(x=NMDS1, y=NMDS2, colour=factor(env.9512$Time)),
alpha=0.5)+
geom_segment(data=subset(fort, score=='species'),
mapping=aes(x=0, y=0, xend=NMDS1, yend=NMDS2),
arrow = arrow(length =unit(0.015, "npc"), type="closed"),
colour="darkgray", size=0, alpha=0)+
geom_text(data=subset(fort, score=='sites'),
mapping = aes(label=label, x=NMDS1*1, y=NMDS2*1),size=3,
family="sans", fontface="italic", alpha=0)+
geom_abline(intercept = 0, slope=0, linetype="dashed", size=0.5, colour="black")+
geom_vline(aes(xintercept=0), linetype="dashed", size=0.5, colour="black")+
scale_x_continuous(guide="prism_minor",
breaks = seq(-20,20,by=1),
limits = c(-2,2),
expand = c(0,0),
minor_breaks=seq(-20,20, 0.5))+
scale_y_continuous(guide="prism_minor",
breaks = seq(-20,20,by=0.5),
limits = c(-1,1),
expand = c(0,0),
minor_breaks=seq(-20,20, 0.25))+
xlab("")+ylab("")+
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
legend.position = c(0.5,0.2),
legend.justification = c("right", "top"),
legend.box.just = "right",
legend.margin = margin(6, 6, 6, 6),
legend.title = element_blank(),
legend.background = element_blank(),
axis.line = element_line(colour = "black"))
p3
#Plot the results
p3<- ggplot(data = data.scores, aes(x = NMDS1, y = NMDS2))+
geom_segment(data = en_coord_cont, aes(x = 0, y = 0, xend = NMDS1, yend = NMDS2),
size =0.5, alpha = 0.5, colour = "grey30") +
# geom_point(data = en_coord_cat, aes(x = NMDS1, y = NMDS2),
#            shape = "diamond", size = 4, alpha = 0.6, colour = "navy") +
# geom_text(data = en_coord_cat, aes(x = NMDS1, y = NMDS2+0.04),
#           label = row.names(en_coord_cat), colour = "navy", fontface = "bold", size=4) +
geom_text(data = en_coord_cont, aes(x = NMDS1, y = NMDS2), colour = "grey30",
fontface = "bold", size=4, label = row.names(en_coord_cont)) +
geom_point(data=subset(fort, score=='sites'),
mapping=aes(x=NMDS1, y=NMDS2, colour=factor(env.9512$Time)),
alpha=0.5)+
geom_segment(data=subset(fort, score=='species'),
mapping=aes(x=0, y=0, xend=NMDS1, yend=NMDS2),
arrow = arrow(length =unit(0.015, "npc"), type="closed"),
colour="darkgray", size=0, alpha=0)+
geom_text(data=subset(fort, score=='sites'),
mapping = aes(label=label, x=NMDS1*1, y=NMDS2*1),size=3,
family="sans", fontface="italic", alpha=0)+
geom_abline(intercept = 0, slope=0, linetype="dashed", size=0.5, colour="black")+
geom_vline(aes(xintercept=0), linetype="dashed", size=0.5, colour="black")+
scale_x_continuous(guide="prism_minor",
breaks = seq(-20,20,by=1),
limits = c(-2,2),
expand = c(0,0),
minor_breaks=seq(-20,20, 0.5))+
scale_y_continuous(guide="prism_minor",
breaks = seq(-20,20,by=0.5),
limits = c(-1,1),
expand = c(0,0),
minor_breaks=seq(-20,20, 0.25))+
xlab("")+ylab("")+
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
legend.position = c(0.5,0.7),
legend.justification = c("right", "top"),
legend.box.just = "right",
legend.margin = margin(6, 6, 6, 6),
legend.title = element_blank(),
legend.background = element_blank(),
axis.line = element_line(colour = "black"))
p3
#Plot the results
p3<- ggplot(data = data.scores, aes(x = NMDS1, y = NMDS2))+
geom_segment(data = en_coord_cont, aes(x = 0, y = 0, xend = NMDS1, yend = NMDS2),
size =0.5, alpha = 0.5, colour = "grey30") +
# geom_point(data = en_coord_cat, aes(x = NMDS1, y = NMDS2),
#            shape = "diamond", size = 4, alpha = 0.6, colour = "navy") +
# geom_text(data = en_coord_cat, aes(x = NMDS1, y = NMDS2+0.04),
#           label = row.names(en_coord_cat), colour = "navy", fontface = "bold", size=4) +
geom_text(data = en_coord_cont, aes(x = NMDS1, y = NMDS2), colour = "grey30",
fontface = "bold", size=4, label = row.names(en_coord_cont)) +
geom_point(data=subset(fort, score=='sites'),
mapping=aes(x=NMDS1, y=NMDS2, colour=factor(env.9512$Time)),
alpha=0.5)+
geom_segment(data=subset(fort, score=='species'),
mapping=aes(x=0, y=0, xend=NMDS1, yend=NMDS2),
arrow = arrow(length =unit(0.015, "npc"), type="closed"),
colour="darkgray", size=0, alpha=0)+
geom_text(data=subset(fort, score=='sites'),
mapping = aes(label=label, x=NMDS1*1, y=NMDS2*1),size=3,
family="sans", fontface="italic", alpha=0)+
geom_abline(intercept = 0, slope=0, linetype="dashed", size=0.5, colour="black")+
geom_vline(aes(xintercept=0), linetype="dashed", size=0.5, colour="black")+
scale_x_continuous(guide="prism_minor",
breaks = seq(-20,20,by=1),
limits = c(-2,2),
expand = c(0,0),
minor_breaks=seq(-20,20, 0.5))+
scale_y_continuous(guide="prism_minor",
breaks = seq(-20,20,by=0.5),
limits = c(-1,1),
expand = c(0,0),
minor_breaks=seq(-20,20, 0.25))+
xlab("")+ylab("")+
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
legend.position = c(0.5,0.8),
legend.justification = c("right", "top"),
legend.box.just = "right",
legend.margin = margin(6, 6, 6, 6),
legend.title = element_blank(),
legend.background = element_blank(),
axis.line = element_line(colour = "black"))
p3
#Plot the results
p3<- ggplot(data = data.scores, aes(x = NMDS1, y = NMDS2))+
geom_segment(data = en_coord_cont, aes(x = 0, y = 0, xend = NMDS1, yend = NMDS2),
size =0.5, alpha = 0.5, colour = "grey30") +
# geom_point(data = en_coord_cat, aes(x = NMDS1, y = NMDS2),
#            shape = "diamond", size = 4, alpha = 0.6, colour = "navy") +
# geom_text(data = en_coord_cat, aes(x = NMDS1, y = NMDS2+0.04),
#           label = row.names(en_coord_cat), colour = "navy", fontface = "bold", size=4) +
geom_text(data = en_coord_cont, aes(x = NMDS1, y = NMDS2), colour = "grey30",
fontface = "bold", size=4, label = row.names(en_coord_cont)) +
geom_point(data=subset(fort, score=='sites'),
mapping=aes(x=NMDS1, y=NMDS2, colour=factor(env.9512$Time)),
alpha=0.5)+
geom_segment(data=subset(fort, score=='species'),
mapping=aes(x=0, y=0, xend=NMDS1, yend=NMDS2),
arrow = arrow(length =unit(0.015, "npc"), type="closed"),
colour="darkgray", size=0, alpha=0)+
geom_text(data=subset(fort, score=='sites'),
mapping = aes(label=label, x=NMDS1*1, y=NMDS2*1),size=3,
family="sans", fontface="italic", alpha=0)+
geom_abline(intercept = 0, slope=0, linetype="dashed", size=0.5, colour="black")+
geom_vline(aes(xintercept=0), linetype="dashed", size=0.5, colour="black")+
scale_x_continuous(guide="prism_minor",
breaks = seq(-20,20,by=1),
limits = c(-1.5,1.5),
expand = c(0,0),
minor_breaks=seq(-20,20, 0.5))+
scale_y_continuous(guide="prism_minor",
breaks = seq(-20,20,by=0.5),
limits = c(-1.5,1.5),
expand = c(0,0),
minor_breaks=seq(-20,20, 0.25))+
xlab("")+ylab("")+
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
legend.position = c(0.5,0.8),
legend.justification = c("right", "top"),
legend.box.just = "right",
legend.margin = margin(6, 6, 6, 6),
legend.title = element_blank(),
legend.background = element_blank(),
axis.line = element_line(colour = "black"))
p3
#Plot the results
p3<- ggplot(data = data.scores, aes(x = NMDS1, y = NMDS2))+
geom_segment(data = en_coord_cont, aes(x = 0, y = 0, xend = NMDS1, yend = NMDS2),
size =0.5, alpha = 0.5, colour = "grey30") +
# geom_point(data = en_coord_cat, aes(x = NMDS1, y = NMDS2),
#            shape = "diamond", size = 4, alpha = 0.6, colour = "navy") +
# geom_text(data = en_coord_cat, aes(x = NMDS1, y = NMDS2+0.04),
#           label = row.names(en_coord_cat), colour = "navy", fontface = "bold", size=4) +
geom_text(data = en_coord_cont, aes(x = NMDS1, y = NMDS2), colour = "grey30",
fontface = "bold", size=4, label = row.names(en_coord_cont)) +
geom_point(data=subset(fort, score=='sites'),
mapping=aes(x=NMDS1, y=NMDS2, colour=factor(env.9512$Time)),
alpha=0.5)+
geom_segment(data=subset(fort, score=='species'),
mapping=aes(x=0, y=0, xend=NMDS1, yend=NMDS2),
arrow = arrow(length =unit(0.015, "npc"), type="closed"),
colour="darkgray", size=0, alpha=0)+
geom_text(data=subset(fort, score=='sites'),
mapping = aes(label=label, x=NMDS1*1, y=NMDS2*1),size=3,
family="sans", fontface="italic", alpha=0)+
geom_abline(intercept = 0, slope=0, linetype="dashed", size=0.5, colour="black")+
geom_vline(aes(xintercept=0), linetype="dashed", size=0.5, colour="black")+
scale_x_continuous(guide="prism_minor",
breaks = seq(-20,20,by=1),
limits = c(-1.5,1.5),
expand = c(0,0),
minor_breaks=seq(-20,20, 0.5))+
scale_y_continuous(guide="prism_minor",
breaks = seq(-20,20,by=0.5),
limits = c(-1.5,1.5),
expand = c(0,0),
minor_breaks=seq(-20,20, 0.25))+
xlab("")+ylab("")+
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
legend.position = c(0.5,1),
legend.justification = c("right", "top"),
legend.box.just = "right",
legend.margin = margin(6, 6, 6, 6),
legend.title = element_blank(),
legend.background = element_blank(),
axis.line = element_line(colour = "black"))
p3
#Plot the results
p3<- ggplot(data = data.scores, aes(x = NMDS1, y = NMDS2))+
geom_segment(data = en_coord_cont, aes(x = 0, y = 0, xend = NMDS1, yend = NMDS2),
size =0.5, alpha = 0.5, colour = "grey30") +
# geom_point(data = en_coord_cat, aes(x = NMDS1, y = NMDS2),
#            shape = "diamond", size = 4, alpha = 0.6, colour = "navy") +
# geom_text(data = en_coord_cat, aes(x = NMDS1, y = NMDS2+0.04),
#           label = row.names(en_coord_cat), colour = "navy", fontface = "bold", size=4) +
geom_text(data = en_coord_cont, aes(x = NMDS1, y = NMDS2), colour = "grey30",
fontface = "bold", size=4, label = row.names(en_coord_cont)) +
geom_point(data=subset(fort, score=='sites'),
mapping=aes(x=NMDS1, y=NMDS2, colour=factor(env.9512$Time)),
alpha=0.5)+
geom_segment(data=subset(fort, score=='species'),
mapping=aes(x=0, y=0, xend=NMDS1, yend=NMDS2),
arrow = arrow(length =unit(0.015, "npc"), type="closed"),
colour="darkgray", size=0, alpha=0)+
geom_text(data=subset(fort, score=='sites'),
mapping = aes(label=label, x=NMDS1*1, y=NMDS2*1),size=3,
family="sans", fontface="italic", alpha=0)+
geom_abline(intercept = 0, slope=0, linetype="dashed", size=0.5, colour="black")+
geom_vline(aes(xintercept=0), linetype="dashed", size=0.5, colour="black")+
scale_x_continuous(guide="prism_minor",
breaks = seq(-20,20,by=1),
limits = c(-1.5,1.5),
expand = c(0,0),
minor_breaks=seq(-20,20, 0.5))+
scale_y_continuous(guide="prism_minor",
breaks = seq(-20,20,by=0.5),
limits = c(-1.5,1.5),
expand = c(0,0),
minor_breaks=seq(-20,20, 0.25))+
xlab("")+ylab("")+
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
legend.position = c(0.3,1),
legend.justification = c("right", "top"),
legend.box.just = "right",
legend.margin = margin(6, 6, 6, 6),
legend.title = element_blank(),
legend.background = element_blank(),
axis.line = element_line(colour = "black"))
p3
#Plot the results
p3<- ggplot(data = data.scores, aes(x = NMDS1, y = NMDS2))+
geom_segment(data = en_coord_cont, aes(x = 0, y = 0, xend = NMDS1, yend = NMDS2),
size =0.5, alpha = 0.5, colour = "grey30") +
# geom_point(data = en_coord_cat, aes(x = NMDS1, y = NMDS2),
#            shape = "diamond", size = 4, alpha = 0.6, colour = "navy") +
# geom_text(data = en_coord_cat, aes(x = NMDS1, y = NMDS2+0.04),
#           label = row.names(en_coord_cat), colour = "navy", fontface = "bold", size=4) +
geom_text(data = en_coord_cont, aes(x = NMDS1, y = NMDS2), colour = "grey30",
fontface = "bold", size=4, label = row.names(en_coord_cont)) +
geom_point(data=subset(fort, score=='sites'),
mapping=aes(x=NMDS1, y=NMDS2, colour=factor(env.9512$Time)),
alpha=0.5)+
geom_segment(data=subset(fort, score=='species'),
mapping=aes(x=0, y=0, xend=NMDS1, yend=NMDS2),
arrow = arrow(length =unit(0.015, "npc"), type="closed"),
colour="darkgray", size=0, alpha=0)+
geom_text(data=subset(fort, score=='sites'),
mapping = aes(label=label, x=NMDS1*1, y=NMDS2*1),size=3,
family="sans", fontface="italic", alpha=0)+
geom_abline(intercept = 0, slope=0, linetype="dashed", size=0.5, colour="black")+
geom_vline(aes(xintercept=0), linetype="dashed", size=0.5, colour="black")+
scale_x_continuous(guide="prism_minor",
breaks = seq(-20,20,by=1),
limits = c(-1.5,1.5),
expand = c(0,0),
minor_breaks=seq(-20,20, 0.5))+
scale_y_continuous(guide="prism_minor",
breaks = seq(-20,20,by=0.5),
limits = c(-1.5,1.5),
expand = c(0,0),
minor_breaks=seq(-20,20, 0.25))+
xlab("")+ylab("")+
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
legend.position = c(0.35,1),
legend.justification = c("right", "top"),
legend.box.just = "right",
legend.margin = margin(6, 6, 6, 6),
legend.title = element_blank(),
legend.background = element_blank(),
axis.line = element_line(colour = "black"))
p3
ggarrange(p3, p2, ncol = 1)
#Visualize NMDS
ggarrange(p3, p2, nrow=1)
