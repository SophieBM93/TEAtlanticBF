names(melted)[1] <- "Age"
melted$Age <- as.numeric(melted$Age)
AbundSp <- ggplot(melted, aes(x=value,y= Age, fill=variable))+
geom_hline(yintercept = 6.6, linetype = 2, linewidth = 0.5, alpha=0.7, colour="darkgreen")+
geom_rect(mapping = aes(ymin = ymin, ymax = ymax, xmin = xmin, xmax = xmax),
data = LGM, alpha = 0.6, fill = "#c7c7c7", inherit.aes = FALSE)+
geom_rect(mapping = aes(ymin = ymin, ymax = ymax, xmin = xmin, xmax = xmax),
data = HS1, alpha = 0.4, fill = "#A6B578",inherit.aes = FALSE)+
geom_hline(yintercept = 16.79, linetype=2, linewidth=0.5, alpha=0)+
geom_rect(mapping = aes(ymin = ymin, ymax = ymax, xmin = xmin, xmax = xmax),
data = HS2, alpha = 0.4, fill = "#A6B578",inherit.aes = FALSE)+
geom_rect(mapping = aes(ymin = ymin, ymax = ymax, xmin = xmin, xmax = xmax),
data = YD, alpha = 0.6, fill = "#c7c7c7", inherit.aes = FALSE)+
geom_hline(yintercept = 7.12, linetype = 2, linewidth = 0.5, alpha=0.5)+
geom_hline(yintercept = 15.71, linetype = 2, linewidth = 0.5, alpha=0.5)+
geom_hline(yintercept = 16.18, linetype = 2, linewidth = 0.5, alpha=0.5)+
geom_hline(yintercept = 23.76, linetype = 1, linewidth = 0.5, alpha=0.5)+
geom_hline(yintercept = 18.28, linetype = 1, linewidth = 0.5, alpha=0.5)+
geom_hline(yintercept = 17.64, linetype = 1, linewidth = 0.5, alpha=0.5)+
geom_hline(yintercept = 14.19, linetype = 1, linewidth = 0.5, alpha=0.5)+
geom_hline(yintercept = 12.97, linetype = 1, linewidth = 0.5, alpha=0.5)+
geom_hline(yintercept = 11.62, linetype = 1, linewidth = 0.5, alpha=0.5)+
geom_hline(yintercept = 10.98, linetype = 1, linewidth = 0.5, alpha=0.5)+
geom_areah()+
scale_y_reverse(guide="prism_minor",
breaks = seq(50,0,by=-5),
limits = c(27,0),
expand = c(0,0),
minor_breaks=seq(50, 0, -1))+
scale_x_continuous(guide="prism_minor",
breaks = seq(0,100,by=20),
limits = c(0,75),
expand = c(0,0),
minor_breaks=seq(0,100, 10))+
scale_fill_manual(values = c("black","black","black","black", "black","black",
"grey","grey", "black","grey","black", "#FFBABA",
"black","black","black","black","grey", "black",
"grey","#FFBABA", "#FFBABA", "#FFBABA", "#AFCAE6", "gray",
"black","black","black"))+
theme_classic()+
theme(legend.position = "none",
axis.line = element_line(linetype = 1, size = 0.5),
axis.ticks = element_line(linetype = 1, size = 0.5),
plot.title = element_text(size = 11, family = "sans", hjust = 0.5, face="bold"),
axis.text = element_text(size = 10, family = "sans"))+
facet_wrap(~ variable, nrow=1)
AbundSp
ab1PF2 <- ab1PF                                               #Data for NMDS (see 1.4)
ab1PF.Q <- (ab1PF2*rowSums(ab1))/100                          #returns to BF counts
ab1PF.Q.Hel <-decostand(ab1PF.Q, method="hellinger")          #standarizes data
nmds <- metaMDS(ab1PF.Q.Hel, distance = "bray", k=4,
trymax=1000000, autotransform = F)             #run NMDS
nmds
stressplot(nmds)                                              #check Stress Plot
nmds$points
scores(nmds)
df1 <- cbind(ab1PF.Q.Hel, envNMDS)
df1_b <- ab1PF.Q.Hel[,1:17]
ano <- anosim(ab1PF, df1$`BWOx[mL/L]`, distance = "bray", permutations = 9999)
ano
# 2.2 Import Environmental Data (Fot Plot)
env.9512 <- read.csv("9512EA.csv", check.names = F)
env.9512 <- replace(env.9512,is.na(env.9512),0)                         #Replacing NA values by 0
env.9512<- env.9512[rowSums(env.9512[,4:5])>0,]                         #Delete 0 rows
# Plot the NMDS
fort <- fortify(nmds)
#### Make a 2 panel plot to reduce complexity
p1<- ggplot()+
geom_point(data=subset(fort, score=='sites'),
mapping=aes(x=NMDS1, y=NMDS2, shape = factor(env.9512$OM),
colour=factor(env.9512$Time)),
size=3, alpha=0.5)+
geom_segment(data=subset(fort, score=='species'),
mapping=aes(x=0, y=0, xend=NMDS1, yend=NMDS2),
arrow = arrow(length =unit(0.015, "npc"), type="closed"),
colour="darkgray", size=0, alpha=0)+
geom_text(data=subset(fort, score=='species'),
mapping = aes(label=label, x=NMDS1*1.3, y=NMDS2*1.3),size=3,
family="serif", fontface="italic", alpha=0)+
geom_abline(intercept = 0, slope=0, linetype="dashed", size=0.5, colour="black")+
geom_vline(aes(xintercept=0), linetype="dashed", size=0.5, colour="black")+
scale_x_continuous(guide="prism_minor",
breaks = seq(-20,20,by=0.5),
limits = c(-1,1),
expand = c(0,0),
minor_breaks=seq(-20,20, 0.25))+
scale_y_continuous(guide="prism_minor",
breaks = seq(-20,20,by=0.5),
limits = c(-1,1),
expand = c(0,0),
minor_breaks=seq(-20,20, 0.25))+
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
legend.position = c(0.25, 1),
legend.justification = c("right", "top"),
legend.box.just = "right",
legend.margin = margin(4,4,4,4),
legend.title = element_blank(),
legend.background = element_blank(),
axis.line = element_line(linetype = 1, size = 0.5),
axis.ticks = element_line(linetype = 1, size = 0.5),
plot.title = element_text(size = 11, family = "sans", hjust = 0.5, face="bold"),
axis.text = element_text(size = 10, family = "sans")) +
guides(color = guide_legend(ncol = 2))
p1
# Saves NMDS
pdf(file = "GeoB9512_NMDSV3.pdf", paper = "a4r", bg="transparent", height = 5, width = 30)
ggarrange(p1)
dev.off()
## Environmental fit variables in NMDS
## 2.3 Set Data
env2 <- env.9512                                           #Data for NMDS
# 2.4 Extract the varibales of interest
envNMDS <- cbind(env2$`Age [ka]`, env2$`DO3[mL/L]`, env2$`Infaunals[%]`,
env2$`Epibenthic[%]`, env2$`Calcareous[%]`, env2$`Porcellaneous[%]`,
env2$FAI, env2$`(2) porcentage - C. robertsonianus`)
envNMDS <- as.data.frame(envNMDS)
colnames(envNMDS)<- c("Age (ka)", "BWOx[mL/L]", "Infaunals [%]",
"Epifaunals [%]", "Calcareous [%]",
"Porcellaneous [%]", "FAI", "Elevated Epifauna")
str(envNMDS)
# 2.5 Calculate environmental fit for variables
env <- envNMDS[2:8]
en = envfit(nmds, env, permutations = 999, na.rm = TRUE)
data.scores = as.data.frame(scores(nmds, display="species"))
en_coord_cont = as.data.frame(scores(en, "vectors")) * ordiArrowMul(en)
en_coord_cat = as.data.frame(scores(en, "factors")) * ordiArrowMul(en)
# 2.6 Plot the results
p3<- ggplot(data = data.scores, aes(x = NMDS1, y = NMDS2))+
geom_segment(data = en_coord_cont, aes(x = 0, y = 0, xend = NMDS1, yend = NMDS2),
size =0.5, alpha = 0.5, colour = "grey30") +
# geom_point(data = en_coord_cat, aes(x = NMDS1, y = NMDS2),
#            shape = "diamond", size = 4, alpha = 0.6, colour = "navy") +
# geom_text(data = en_coord_cat, aes(x = NMDS1, y = NMDS2+0.04),
#           label = row.names(en_coord_cat), colour = "navy", fontface = "bold", size=4) +
geom_text(data = en_coord_cont, aes(x = NMDS1, y = NMDS2), colour = "grey30",
fontface = "bold", size=4, label = row.names(en_coord_cont)) +
geom_point(data=subset(fort, score=='sites'),
mapping=aes(x=NMDS1, y=NMDS2, colour=factor(env.9512$Time), shape=factor(env.9512$OM)),
alpha=0.5, size=4)+
geom_segment(data=subset(fort, score=='species'),
mapping=aes(x=0, y=0, xend=NMDS1, yend=NMDS2),
arrow = arrow(length =unit(0.015, "npc"), type="closed"),
colour="darkgray", size=0, alpha=0)+
geom_text(data=subset(fort, score=='sites'),
mapping = aes(label=label, x=NMDS1*1, y=NMDS2*1),size=3,
family="sans", fontface="italic", alpha=0)+
geom_abline(intercept = 0, slope=0, linetype="dashed", size=0.5, colour="black")+
geom_vline(aes(xintercept=0), linetype="dashed", size=0.5, colour="black")+
scale_x_continuous(guide="prism_minor",
breaks = seq(-20,20,by=1),
limits = c(-1,1),
expand = c(0,0),
minor_breaks=seq(-20,20, 0.5))+
scale_y_continuous(guide="prism_minor",
breaks = seq(-20,20,by=0.5),
limits = c(-1.5,1.5),
expand = c(0,0),
minor_breaks=seq(-20,20, 0.25))+
xlab("")+ylab("")+
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
legend.position = c(0.1,1),
legend.justification = c("right", "top"),
legend.box.just = "right",
legend.margin = margin(6, 6, 6, 6),
legend.title = element_blank(),
legend.background = element_blank(),
axis.line = element_line(colour = "black"))
p3
# 1.3) Plot EBFOI
EBFOIPlot <- ggplot(env.9512, aes(EBFOI, `Age [ka]`))+
geom_hline(yintercept = 6.6, linetype = 2, linewidth = 0.5, alpha=0.5)+
geom_rect(mapping = aes(ymin = ymin, ymax = ymax, xmin = xmin, xmax = xmax),
data = LGM, alpha = 0.6, fill = "#c7c7c7", inherit.aes = FALSE)+
geom_rect(mapping = aes(ymin = ymin, ymax = ymax, xmin = xmin, xmax = xmax),
data = HS1, alpha = 0.4, fill = "#A6B578",inherit.aes = FALSE)+
geom_hline(yintercept = 16.79, linetype=2, linewidth=0.5, alpha=0.5)+
geom_rect(mapping = aes(ymin = ymin, ymax = ymax, xmin = xmin, xmax = xmax),
data = HS2, alpha = 0.4, fill = "#A6B578",inherit.aes = FALSE)+
geom_rect(mapping = aes(ymin = ymin, ymax = ymax, xmin = xmin, xmax = xmax),
data = YD, alpha = 0.6, fill = "#c7c7c7", inherit.aes = FALSE)+
geom_lineh()+
scale_y_reverse(guide="prism_minor",
breaks = seq(50,0,by=-5),
limits = c(27,0),
expand = c(0,0),
minor_breaks=seq(50, 0, -1))+
scale_x_continuous(guide="prism_minor",
breaks = seq(0,20,by=5),
limits = c(5,20),
expand = c(0,0),
minor_breaks=seq(0,20, 1))+
labs(title = "Benthic Foraminifera Diversity (Fisher Alpha")+
ylab ("") +
xlab ("") +
scale_color_continuous(type = "viridis")+
theme_classic()+
theme(axis.line.x = element_line(linetype = 1, size = 0.5),
axis.ticks.x = element_line(linetype = 1, size = 0.5),
plot.title = element_text(size = 11, family = "sans", hjust = 0.5, face="bold"),
axis.text = element_text(size = 10, family = "sans"))
EBFOIPlot
# 1.3) Plot EBFOI
EBFOIPlot <- ggplot(env.9512, aes(EBFOI, `Age [ka]`))+
geom_hline(yintercept = 6.6, linetype = 2, linewidth = 0.5, alpha=0.5)+
geom_rect(mapping = aes(ymin = ymin, ymax = ymax, xmin = xmin, xmax = xmax),
data = LGM, alpha = 0.6, fill = "#c7c7c7", inherit.aes = FALSE)+
geom_rect(mapping = aes(ymin = ymin, ymax = ymax, xmin = xmin, xmax = xmax),
data = HS1, alpha = 0.4, fill = "#A6B578",inherit.aes = FALSE)+
geom_hline(yintercept = 16.79, linetype=2, linewidth=0.5, alpha=0.5)+
geom_rect(mapping = aes(ymin = ymin, ymax = ymax, xmin = xmin, xmax = xmax),
data = HS2, alpha = 0.4, fill = "#A6B578",inherit.aes = FALSE)+
geom_rect(mapping = aes(ymin = ymin, ymax = ymax, xmin = xmin, xmax = xmax),
data = YD, alpha = 0.6, fill = "#c7c7c7", inherit.aes = FALSE)+
geom_lineh()+
scale_y_reverse(guide="prism_minor",
breaks = seq(50,0,by=-5),
limits = c(27,0),
expand = c(0,0),
minor_breaks=seq(50, 0, -1))+
scale_x_continuous(guide="prism_minor",
breaks = seq(0,100,by=5),
limits = c(0,80),
expand = c(0,0),
minor_breaks=seq(0,100, 1))+
labs(title = "Benthic Foraminifera Diversity (Fisher Alpha")+
ylab ("") +
xlab ("") +
scale_color_continuous(type = "viridis")+
theme_classic()+
theme(axis.line.x = element_line(linetype = 1, size = 0.5),
axis.ticks.x = element_line(linetype = 1, size = 0.5),
plot.title = element_text(size = 11, family = "sans", hjust = 0.5, face="bold"),
axis.text = element_text(size = 10, family = "sans"))
EBFOIPlot
# 1.3) Plot EBFOI
EBFOIPlot <- ggplot(env.9512, aes(EBFOI, `Age [ka]`))+
geom_hline(yintercept = 6.6, linetype = 2, linewidth = 0.5, alpha=0.5)+
geom_rect(mapping = aes(ymin = ymin, ymax = ymax, xmin = xmin, xmax = xmax),
data = LGM, alpha = 0.6, fill = "#c7c7c7", inherit.aes = FALSE)+
geom_rect(mapping = aes(ymin = ymin, ymax = ymax, xmin = xmin, xmax = xmax),
data = HS1, alpha = 0.4, fill = "#A6B578",inherit.aes = FALSE)+
geom_hline(yintercept = 16.79, linetype=2, linewidth=0.5, alpha=0.5)+
geom_rect(mapping = aes(ymin = ymin, ymax = ymax, xmin = xmin, xmax = xmax),
data = HS2, alpha = 0.4, fill = "#A6B578",inherit.aes = FALSE)+
geom_rect(mapping = aes(ymin = ymin, ymax = ymax, xmin = xmin, xmax = xmax),
data = YD, alpha = 0.6, fill = "#c7c7c7", inherit.aes = FALSE)+
geom_lineh()+
scale_y_reverse(guide="prism_minor",
breaks = seq(50,0,by=-5),
limits = c(27,0),
expand = c(0,0),
minor_breaks=seq(50, 0, -1))+
scale_x_continuous(guide="prism_minor",
breaks = seq(0,100,by=5),
limits = c(0,80),
expand = c(0,0),
minor_breaks=seq(0,100, 1))+
labs(title = "EBFOI")+
ylab ("") +
xlab ("") +
scale_color_continuous(type = "viridis")+
theme_classic()+
theme(axis.line.x = element_line(linetype = 1, size = 0.5),
axis.ticks.x = element_line(linetype = 1, size = 0.5),
plot.title = element_text(size = 11, family = "sans", hjust = 0.5, face="bold"),
axis.text = element_text(size = 10, family = "sans"))
EBFOIPlot
# 1.3) Plot EBFOI
EBFOIPlot <- ggplot(env.9512, aes(EBFOI, `Age [ka]`))+
geom_hline(yintercept = 6.6, linetype = 2, linewidth = 0.5, alpha=0.5)+
geom_rect(mapping = aes(ymin = ymin, ymax = ymax, xmin = xmin, xmax = xmax),
data = LGM, alpha = 0.6, fill = "#c7c7c7", inherit.aes = FALSE)+
geom_rect(mapping = aes(ymin = ymin, ymax = ymax, xmin = xmin, xmax = xmax),
data = HS1, alpha = 0.4, fill = "#A6B578",inherit.aes = FALSE)+
geom_hline(yintercept = 16.79, linetype=2, linewidth=0.5, alpha=0.5)+
geom_rect(mapping = aes(ymin = ymin, ymax = ymax, xmin = xmin, xmax = xmax),
data = HS2, alpha = 0.4, fill = "#A6B578",inherit.aes = FALSE)+
geom_rect(mapping = aes(ymin = ymin, ymax = ymax, xmin = xmin, xmax = xmax),
data = YD, alpha = 0.6, fill = "#c7c7c7", inherit.aes = FALSE)+
geom_rect(mapping = aes(ymin = ymin, ymax = ymax, xmin = 50, xmax = 100),
alpha = 0.4, fill = "#A6B578",inherit.aes = FALSE)+
geom_lineh()+
scale_y_reverse(guide="prism_minor",
breaks = seq(50,0,by=-5),
limits = c(27,0),
expand = c(0,0),
minor_breaks=seq(50, 0, -1))+
scale_x_continuous(guide="prism_minor",
breaks = seq(0,100,by=5),
limits = c(0,80),
expand = c(0,0),
minor_breaks=seq(0,100, 1))+
labs(title = "EBFOI")+
ylab ("") +
xlab ("") +
scale_color_continuous(type = "viridis")+
theme_classic()+
theme(axis.line.x = element_line(linetype = 1, size = 0.5),
axis.ticks.x = element_line(linetype = 1, size = 0.5),
plot.title = element_text(size = 11, family = "sans", hjust = 0.5, face="bold"),
axis.text = element_text(size = 10, family = "sans"))
EBFOIPlot
# 1.3) Plot EBFOI
EBFOIPlot <- ggplot(env.9512, aes(EBFOI, `Age [ka]`))+
geom_hline(yintercept = 6.6, linetype = 2, linewidth = 0.5, alpha=0.5)+
geom_rect(mapping = aes(ymin = ymin, ymax = ymax, xmin = xmin, xmax = xmax),
data = LGM, alpha = 0.6, fill = "#c7c7c7", inherit.aes = FALSE)+
geom_rect(mapping = aes(ymin = ymin, ymax = ymax, xmin = xmin, xmax = xmax),
data = HS1, alpha = 0.4, fill = "#A6B578",inherit.aes = FALSE)+
geom_hline(yintercept = 16.79, linetype=2, linewidth=0.5, alpha=0.5)+
geom_rect(mapping = aes(ymin = ymin, ymax = ymax, xmin = xmin, xmax = xmax),
data = HS2, alpha = 0.4, fill = "#A6B578",inherit.aes = FALSE)+
geom_rect(mapping = aes(ymin = ymin, ymax = ymax, xmin = xmin, xmax = xmax),
data = YD, alpha = 0.6, fill = "#c7c7c7", inherit.aes = FALSE)+
geom_rect(mapping = aes(ymin = 27, ymax = 0, xmin = 50, xmax = 100),
alpha = 0.4, fill = "#A6B578",inherit.aes = FALSE)+
geom_lineh()+
scale_y_reverse(guide="prism_minor",
breaks = seq(50,0,by=-5),
limits = c(27,0),
expand = c(0,0),
minor_breaks=seq(50, 0, -1))+
scale_x_continuous(guide="prism_minor",
breaks = seq(0,100,by=5),
limits = c(0,80),
expand = c(0,0),
minor_breaks=seq(0,100, 1))+
labs(title = "EBFOI")+
ylab ("") +
xlab ("") +
scale_color_continuous(type = "viridis")+
theme_classic()+
theme(axis.line.x = element_line(linetype = 1, size = 0.5),
axis.ticks.x = element_line(linetype = 1, size = 0.5),
plot.title = element_text(size = 11, family = "sans", hjust = 0.5, face="bold"),
axis.text = element_text(size = 10, family = "sans"))
EBFOIPlot
# 1.3) Plot EBFOI
EBFOIPlot <- ggplot(env.9512, aes(EBFOI, `Age [ka]`))+
geom_hline(yintercept = 6.6, linetype = 2, linewidth = 0.5, alpha=0.5)+
geom_rect(mapping = aes(ymin = ymin, ymax = ymax, xmin = xmin, xmax = xmax),
data = LGM, alpha = 0.6, fill = "#c7c7c7", inherit.aes = FALSE)+
geom_rect(mapping = aes(ymin = ymin, ymax = ymax, xmin = xmin, xmax = xmax),
data = HS1, alpha = 0.4, fill = "#A6B578",inherit.aes = FALSE)+
geom_hline(yintercept = 16.79, linetype=2, linewidth=0.5, alpha=0.5)+
geom_rect(mapping = aes(ymin = ymin, ymax = ymax, xmin = xmin, xmax = xmax),
data = HS2, alpha = 0.4, fill = "#A6B578",inherit.aes = FALSE)+
geom_rect(mapping = aes(ymin = ymin, ymax = ymax, xmin = xmin, xmax = xmax),
data = YD, alpha = 0.6, fill = "#c7c7c7", inherit.aes = FALSE)+
geom_rect(mapping = aes(xmin = 50, xmax = 100),
alpha = 0.4, fill = "#A6B578",inherit.aes = FALSE)+
geom_lineh()+
scale_y_reverse(guide="prism_minor",
breaks = seq(50,0,by=-5),
limits = c(27,0),
expand = c(0,0),
minor_breaks=seq(50, 0, -1))+
scale_x_continuous(guide="prism_minor",
breaks = seq(0,100,by=5),
limits = c(0,80),
expand = c(0,0),
minor_breaks=seq(0,100, 1))+
labs(title = "EBFOI")+
ylab ("") +
xlab ("") +
scale_color_continuous(type = "viridis")+
theme_classic()+
theme(axis.line.x = element_line(linetype = 1, size = 0.5),
axis.ticks.x = element_line(linetype = 1, size = 0.5),
plot.title = element_text(size = 11, family = "sans", hjust = 0.5, face="bold"),
axis.text = element_text(size = 10, family = "sans"))
EBFOIPlot
# 1.3) Plot EBFOI
EBFOIPlot <- ggplot(env.9512, aes(EBFOI, `Age [ka]`))+
geom_hline(yintercept = 6.6, linetype = 2, linewidth = 0.5, alpha=0.5)+
geom_rect(mapping = aes(ymin = ymin, ymax = ymax, xmin = xmin, xmax = xmax),
data = LGM, alpha = 0.6, fill = "#c7c7c7", inherit.aes = FALSE)+
geom_rect(mapping = aes(ymin = ymin, ymax = ymax, xmin = xmin, xmax = xmax),
data = HS1, alpha = 0.4, fill = "#A6B578",inherit.aes = FALSE)+
geom_hline(yintercept = 16.79, linetype=2, linewidth=0.5, alpha=0.5)+
geom_rect(mapping = aes(ymin = ymin, ymax = ymax, xmin = xmin, xmax = xmax),
data = HS2, alpha = 0.4, fill = "#A6B578",inherit.aes = FALSE)+
geom_rect(mapping = aes(ymin = ymin, ymax = ymax, xmin = xmin, xmax = xmax),
data = YD, alpha = 0.6, fill = "#c7c7c7", inherit.aes = FALSE)+
geom_lineh()+
scale_y_reverse(guide="prism_minor",
breaks = seq(50,0,by=-5),
limits = c(27,0),
expand = c(0,0),
minor_breaks=seq(50, 0, -1))+
scale_x_continuous(guide="prism_minor",
breaks = seq(0,100,by=5),
limits = c(0,80),
expand = c(0,0),
minor_breaks=seq(0,100, 1))+
labs(title = "EBFOI")+
ylab ("") +
xlab ("") +
scale_color_continuous(type = "viridis")+
theme_classic()+
theme(axis.line.x = element_line(linetype = 1, size = 0.5),
axis.ticks.x = element_line(linetype = 1, size = 0.5),
plot.title = element_text(size = 11, family = "sans", hjust = 0.5, face="bold"),
axis.text = element_text(size = 10, family = "sans"))
EBFOIPlot
# 1.3) Plot EBFOI
EBFOIPlot <- ggplot(env.9512, aes(EBFOI, `Age [ka]`))+
geom_hline(yintercept = 6.6, linetype = 2, linewidth = 0.5, alpha=0.5)+
geom_rect(mapping = aes(ymin = ymin, ymax = ymax, xmin = xmin, xmax = xmax),
data = LGM, alpha = 0.6, fill = "#c7c7c7", inherit.aes = FALSE)+
geom_rect(mapping = aes(ymin = ymin, ymax = ymax, xmin = xmin, xmax = xmax),
data = HS1, alpha = 0.4, fill = "#A6B578",inherit.aes = FALSE)+
geom_hline(yintercept = 16.79, linetype=2, linewidth=0.5, alpha=0.5)+
geom_rect(mapping = aes(ymin = ymin, ymax = ymax, xmin = xmin, xmax = xmax),
data = HS2, alpha = 0.4, fill = "#A6B578",inherit.aes = FALSE)+
geom_rect(mapping = aes(ymin = ymin, ymax = ymax, xmin = xmin, xmax = xmax),
data = YD, alpha = 0.6, fill = "#c7c7c7", inherit.aes = FALSE)+
geom_lineh()+
geom_Vline(Xintercept = 50, linetype=2, linewidth=0.5, alpha=0.5)+
scale_y_reverse(guide="prism_minor",
breaks = seq(50,0,by=-5),
limits = c(27,0),
expand = c(0,0),
minor_breaks=seq(50, 0, -1))+
scale_x_continuous(guide="prism_minor",
breaks = seq(0,100,by=5),
limits = c(0,80),
expand = c(0,0),
minor_breaks=seq(0,100, 1))+
labs(title = "EBFOI")+
ylab ("") +
xlab ("") +
scale_color_continuous(type = "viridis")+
theme_classic()+
theme(axis.line.x = element_line(linetype = 1, size = 0.5),
axis.ticks.x = element_line(linetype = 1, size = 0.5),
plot.title = element_text(size = 11, family = "sans", hjust = 0.5, face="bold"),
axis.text = element_text(size = 10, family = "sans"))
EBFOIPlot
# 1.3) Plot EBFOI
EBFOIPlot <- ggplot(env.9512, aes(EBFOI, `Age [ka]`))+
geom_hline(yintercept = 6.6, linetype = 2, linewidth = 0.5, alpha=0.5)+
geom_rect(mapping = aes(ymin = ymin, ymax = ymax, xmin = xmin, xmax = xmax),
data = LGM, alpha = 0.6, fill = "#c7c7c7", inherit.aes = FALSE)+
geom_rect(mapping = aes(ymin = ymin, ymax = ymax, xmin = xmin, xmax = xmax),
data = HS1, alpha = 0.4, fill = "#A6B578",inherit.aes = FALSE)+
geom_hline(yintercept = 16.79, linetype=2, linewidth=0.5, alpha=0.5)+
geom_rect(mapping = aes(ymin = ymin, ymax = ymax, xmin = xmin, xmax = xmax),
data = HS2, alpha = 0.4, fill = "#A6B578",inherit.aes = FALSE)+
geom_rect(mapping = aes(ymin = ymin, ymax = ymax, xmin = xmin, xmax = xmax),
data = YD, alpha = 0.6, fill = "#c7c7c7", inherit.aes = FALSE)+
geom_lineh()+
geom_Vline(xintercept = 50, linetype=2, linewidth=0.5, alpha=0.5)+
scale_y_reverse(guide="prism_minor",
breaks = seq(50,0,by=-5),
limits = c(27,0),
expand = c(0,0),
minor_breaks=seq(50, 0, -1))+
scale_x_continuous(guide="prism_minor",
breaks = seq(0,100,by=5),
limits = c(0,80),
expand = c(0,0),
minor_breaks=seq(0,100, 1))+
labs(title = "EBFOI")+
ylab ("") +
xlab ("") +
scale_color_continuous(type = "viridis")+
theme_classic()+
theme(axis.line.x = element_line(linetype = 1, size = 0.5),
axis.ticks.x = element_line(linetype = 1, size = 0.5),
plot.title = element_text(size = 11, family = "sans", hjust = 0.5, face="bold"),
axis.text = element_text(size = 10, family = "sans"))
# 1.3) Plot EBFOI
EBFOIPlot <- ggplot(env.9512, aes(EBFOI, `Age [ka]`))+
geom_hline(yintercept = 6.6, linetype = 2, linewidth = 0.5, alpha=0.5)+
geom_rect(mapping = aes(ymin = ymin, ymax = ymax, xmin = xmin, xmax = xmax),
data = LGM, alpha = 0.6, fill = "#c7c7c7", inherit.aes = FALSE)+
geom_rect(mapping = aes(ymin = ymin, ymax = ymax, xmin = xmin, xmax = xmax),
data = HS1, alpha = 0.4, fill = "#A6B578",inherit.aes = FALSE)+
geom_hline(yintercept = 16.79, linetype=2, linewidth=0.5, alpha=0.5)+
geom_rect(mapping = aes(ymin = ymin, ymax = ymax, xmin = xmin, xmax = xmax),
data = HS2, alpha = 0.4, fill = "#A6B578",inherit.aes = FALSE)+
geom_rect(mapping = aes(ymin = ymin, ymax = ymax, xmin = xmin, xmax = xmax),
data = YD, alpha = 0.6, fill = "#c7c7c7", inherit.aes = FALSE)+
geom_lineh()+
geom_vline(xintercept = 50, linetype=2, linewidth=0.5, alpha=0.5)+
scale_y_reverse(guide="prism_minor",
breaks = seq(50,0,by=-5),
limits = c(27,0),
expand = c(0,0),
minor_breaks=seq(50, 0, -1))+
scale_x_continuous(guide="prism_minor",
breaks = seq(0,100,by=5),
limits = c(0,80),
expand = c(0,0),
minor_breaks=seq(0,100, 1))+
labs(title = "EBFOI")+
ylab ("") +
xlab ("") +
scale_color_continuous(type = "viridis")+
theme_classic()+
theme(axis.line.x = element_line(linetype = 1, size = 0.5),
axis.ticks.x = element_line(linetype = 1, size = 0.5),
plot.title = element_text(size = 11, family = "sans", hjust = 0.5, face="bold"),
axis.text = element_text(size = 10, family = "sans"))
EBFOIPlot
View(ab1PF.Q)
ab1PF
